/*! odata-array-filter - v0.0.1 - https://github.com/jasongardnerlv/odata-array-filter - (c) 2016 Jason Gardner - licensed MIT */
ODataArrayFilter=function(){"use strict";function a(a,b){for(var c=b.length-1;c>=0;c--)a.indexOf(b[c])===-1&&a.push(b[c]);return a}function b(a){return"$"!==a.charAt(0)&&(a="$filter="+a),ODataParser.parse(a)}function c(a,b,c){return"date"===Object.toType(b)?c(new Date(a).getTime(),b.getTime()):c(a,b)}function d(a){if(!a.type)throw new Error("could not find the field type");if("property"===a.type)return a.name;if("functioncall"!==a.type)throw new Error("unrecognized type: "+a.type);switch(a.func){case"tolower":case"toupper":return d(a.args[0]);case"substringof":return d(a.args[1]);default:throw new Error("unrecognized functioncall func: "+a.func)}}function e(a,b){if(null!==b&&a.type&&"functioncall"===a.type)switch(a.func){case"tolower":return b.toLowerCase();case"toupper":return b.toUpperCase();case"substringof":return b=e(a.args[1],b),b.indexOf(a.args[0].value)>=0}return b}function f(b,c){switch(b.type){case"eq":case"ne":case"lt":case"le":case"gt":case"ge":var g=d(b.left),h=Array.isArray(b.right.value)?b.right.value[0]:b.right.value;return c.filter(function(a){var c=e(b.left,a[g]);return i[b.type+"Evaluator"](c,h)});case"or":return a(f(b.left,c),f(b.right,c));case"and":return f(b.right,f(b.left,c));default:throw new Error("unrecognized expression type: "+b.type)}}function g(a,b){return a.$filter&&(b=f(a.$filter,b)),b}function h(){var a=this;a.parse=function(a){return b(a)},a.filter=function(a,b){return g(a,b)},a.parseAndFilter=function(b,c){return a.filter(a.parse(b),c)}}Object.toType=function(a){return function(b){return b===a?"global":{}.toString.call(b).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}}(this);var i={eqEvaluator:function(a,b){return null===a?"string"==typeof b&&"null"===b.toLowerCase():c(a,b,function(a,b){return a===b})},neEvaluator:function(a,b){return i.eqEvaluator(a,b)===!1},ltEvaluator:function(a,b){return null!==a&&c(a,b,function(a,b){return a<b})},leEvaluator:function(a,b){return null!==a&&c(a,b,function(a,b){return a<=b})},gtEvaluator:function(a,b){return null!==a&&c(a,b,function(a,b){return a>b})},geEvaluator:function(a,b){return null!==a&&c(a,b,function(a,b){return a>=b})}};return new h}();